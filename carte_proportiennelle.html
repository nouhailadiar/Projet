<!DOCTYPE html>

<!--
 // WEBSITE: https://themefisher.com
 // TWITTER: https://twitter.com/themefisher
 // FACEBOOK: https://www.facebook.com/themefisher
 // GITHUB: https://github.com/themefisher/
-->

<html lang="en">
<head>

  <!-- Basic Page Needs
  ================================================== -->
  <meta charset="utf-8">
  <title>géoportail des barrages au Maroc</title>

  <!-- Mobile Specific Metas
  ================================================== -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="One page parallax responsive HTML Template">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <meta name="author" content="Themefisher">
  <meta name="generator" content="Themefisher Bingo HTML Template v1.0">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="images/favicon.jpg" />

  <!-- CSS
  ================================================== -->
  <!-- Themefisher Icon font -->
  <link rel="stylesheet" href="plugins/themefisher-font/style.css">
  <!-- bootstrap.min css -->
  <link rel="stylesheet" href="plugins/bootstrap/bootstrap.min.css">
  <!-- Lightbox.min css -->
  <link rel="stylesheet" href="plugins/lightbox2/css/lightbox.min.css">
  <!-- animation css -->
  <link rel="stylesheet" href="plugins/animate/animate.css">
  <!-- Slick Carousel -->
  <link rel="stylesheet" href="plugins/slick/slick.css">
  <!-- Main Stylesheet -->
  <link rel="stylesheet" href="css/style.css">

</head>
<body id="body">

  <!--
  Start Preloader
  ==================================== -->
  <div id="preloader">
    <div class='preloader'>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <!--
  End Preloader
  ==================================== -->

<!--
Fixed Navigation
==================================== -->
<header class="navigation fixed-top">
  <div class="container">
    <!-- main nav -->
    <nav class="navbar navbar-expand-lg navbar-light px-0">
      <!-- logo -->
      <a class="navbar-brand logo" href="index.html">
        <img loading="lazy" class="logo-default"  alt="logo" src="images/barrage.png" width=50px height=50px/>
		
        <img loading="lazy" class="logo-white" src="images/barrage.png" alt="logo" width=50px height=50px/>
      </a>
      <!-- /logo -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
        aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navigation">
        <ul class="navbar-nav ml-auto text-center">
           <li class="nav-item dropdown active">
            <a class="nav-link" href="index.html">home</a>
             </a>
            
    
          <li class="nav-item ">
            <a class="nav-link" >About Us</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#!" id="navbarDropdown02" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              cartes <i class="tf-ion-chevron-down"></i>
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown02">
              <li><a class="dropdown-item" href="carte_corophlète.html">Taux de reserve des barrages en 2021</a></li>
              <li><a class="dropdown-item" href="carte_proportiennelle.html">reserve des barrages en m^3</a></li>
			        <li><a class="dropdown-item" href="carte_barrages.html">carte des barrages</a></li>
              <li><a class="dropdown-item" href="carte_de_pente.html">Carte de pente</a></li>
              <li><a class="dropdown-item" href="carte_3D.html">Carte 3D de remplissage des barrages</a></li>
		
              
                
             </li>
	       </ul>
	     </li>
		 <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#!" id="navbarDropdown02" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              Requêtes  <i class="tf-ion-chevron-down"></i>
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown02">
              <li><a class="dropdown-item" href="carte_attributaire.html">Requête1</a></li>
              <li><a class="dropdown-item" href="carte_spatiale.html">Requête2</a></li>
              
		
              
                
             </li>
	       </ul>
	     </li>
          
          
          
          
        </ul>
      </div>
    </nav>
    <!-- /main nav -->
  </div>
</header>
<!--
End Fixed Navigation
==================================== -->

<div class="hero-slider">
	<div class="slider-item th-fullpage hero-area" style="background-image: url(images/slider/Barrage_bin_El_ouidane.jpg);">
		<div class="container">
			<div class="row">
				<div class="col-md-12 text-center">
					<h1 data-duration-in=".3" data-animation-in="fadeInUp" data-delay-in=".1">Géoportail des barrages au Maroc </h1>
					<p data-duration-in=".3" data-animation-in="fadeInUp" data-delay-in=".5">.</p>
					
				</div>
			</div>
		</div>
	</div>
	<div class="slider-item th-fullpage hero-area" style="background-image: url(images/slider/barrage-al-massira-top.jpeg);">
		<div class="container">
			<div class="row">
				<div class="col-md-12 text-center">
					<h1 data-duration-in=".3" data-animation-in="fadeInDown" data-delay-in=".1">Géoportail des barrages au Maroc
						</h1>
					<p data-duration-in=".3" data-animation-in="fadeInDown" data-delay-in=".5">barrage Al Massira est située entre Chaouia et Rehamna, sur Oued Oum Er Rabia à 70 km au sud-est de Settat et 100 km au nord-est de Marrakech. 
						</p>
					
				</div>
			</div>
		</div>
	</div>
</div>


	<!-- End header -->

	<!-- Start All Pages -->
	<div class="all-page-title page-breadcrumb">
		<div class="container text-center">
			<div class="row">
				<div class="col-lg-12">
					<h1>Reserve des barrages durant les années 2021 et 2022 </h1>
				</div>
			</div>
		</div>
	</div>
	<!-- End All Pages -->

	<!-- Start blog -->
	<div class="blog-box">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="heading-title text-center">
						<h2> la Carte représente le reserve des barrages en million m^3 au niveau de chaque
							région durant les années 2021 et 2022:</h2>
						<p> </p>
					</div>
				</div>
			</div>

			<html lang="en">

			<head>
				<title>reserve des barrages</title>

        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
        crossorigin=""/>
        <link rel="stylesheet" href="css/style.css">
        <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
        integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
        crossorigin=""></script>

        <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>

        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
        integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
        crossorigin="anonymous"></script>

        <style type="text/css">
          html, body { margin: 0px; padding: 1; height: 100%; }
          #map  {
                  width: 1000px;
                  height: 600px;
                  margin: 15px auto
                }
          
        </style>

    </head>

    <body>
        
        
        

        </div>
        <div id="map"></div>
        <script type="text/javascript" src="regionsmaroc.js"></script>
        <script type="text/javascript">
        $(document).ready(function() {
              var map = L.map('map').setView([28.60, -4.90], 4);
	            
              L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
                  attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
              }).addTo(map);
          
          function Monstyle(feature) {
            return {
              weight: 2,
              opacity: 1,
              color: '#5a5e5f',
              dashArray: '3',
              fillOpacity: 0.8,
              fillColor: '#b3bcbe'
            };
          } 

          var geojson = L.geoJson(regions, {
            style: Monstyle}).addTo(map);

         //Upload Geojson File
         
			$.getJSON("https://raw.githubusercontent.com/nouhailadiar/geojson.nouha/main/geojson.nouha.geojson")
			.done(function(data) {
			    var info = processData(data);
			    createPropSymbols(info.timestamps, data);
          createLegend(info.min,info.max);
			    createSliderUI(info.timestamps);
          
			});

        // Process Data
        function processData(data) {
          
          var timestamps = [];  
          var	min = Infinity; 
          var	max = -Infinity;

          
          for (var feature in data.features) {
              var properties = data.features[feature].properties;

              
              for (var attribute in properties) {
                  if ( attribute != 'FID_' &&
                       attribute != 'Région' &&
                       attribute != 'Nom' &&
                       attribute != 'Lat' &&
                       attribute != 'Lon' )   
                  {
                      if ( $.inArray(attribute,timestamps) ===  -1) { 
                                                        

                          timestamps.push(attribute);  
                      }
                      if (properties[attribute] < min) {
                          min = properties[attribute]; 
                      }
                      if (properties[attribute] > max) {
                          max = properties[attribute]; 
                      }
                  }
              }
          }
          return { 
              timestamps : timestamps,
              min : min,
              max : max
          }
        }

        // Create Propotional Symbols
        function createPropSymbols(timestamps, data) {

          regions = L.geoJson(data, {

              
              pointToLayer: function(feature, latlng) {
                  return L.circleMarker(latlng, { // we use circle marker for the points
                      fillColor: "#e0f3db",  // fill color of the circles
                      color: '#43a2ca',      // border color of the circles
                      weight: 3,             // circle line weight in pixels
                      fillOpacity: 0.5       // fill opacity (0-1)
                  }).on({
                        mouseover: function(e) {
                            this.openPopup();
                            this.setStyle({fillColor: 'black'});  // fill color turns black when mouseover
                        },
                        mouseout: function(e) {
                            this.closePopup();
                            this.setStyle({fillColor: '#e0f3db'});  // fill turns original color when mouseout
                        }
                });
              }
          }).addTo(map);

          updatePropSymbols(timestamps[0]); 
        }

        // Update Propotional Symbols
        function updatePropSymbols(timestamp) {

          regions.eachLayer(function(layer) {  

              var props = layer.feature.properties;  
              var radius = calcPropRadius(props[timestamp]); 

              
              var popupContent = '<b> Région : <b>' + props.Région + '</b> <br />Reserve d eau en m^3 : ' + String(props[timestamp]) ;

              layer.setRadius(radius);  
              layer.bindPopup(popupContent, { offset: new L.Point(0,-radius), autoPan: false }); 
          });
        }

        
        function calcPropRadius(attributeValue) {

          var scaleFactor = 1;   
          var area = attributeValue * scaleFactor;

          return Math.sqrt(area/Math.PI);  
        }


        function createLegend(min, max) {
                if (min < 10) { 
                    min = 10; 
                }
                if (min > 5) { 
                    min = 10; 
                }
                function roundNumber(inNumber) {
                     return (Math.round(inNumber/10) * 10);
                }
                var legend = L.control( { position: 'bottomright'} );    
                legend.onAdd = function(map) {

                var legendContainer = L.DomUtil.create("div", "legend");
                var symbolsContainer = L.DomUtil.create("div", "symbolsContainer");
                var classes = [roundNumber(min), roundNumber((max-min)/2), roundNumber(max)]; 
                var legendCircle;
                var lastRadius = 0;
                var currentRadius;
                var margin;
                L.DomEvent.disableClickPropagation(legendContainer);; 
                $(legendContainer).append("<h3 id='legendTitle'></h3>");

                for (var i = 0; i <= classes.length-1; i++) {

                    legendCircle = L.DomUtil.create("div", "legendCircle");
                    currentRadius = calcPropRadius(classes[i]);
                    margin = -currentRadius - lastRadius - 2;
                    $(legendCircle).attr("style", "width: " + currentRadius*2 +
                        "px; height: " + currentRadius*2 + 
                        "px; margin-left: " + margin + "px" );
                    $(legendCircle).append("<span       class='legendValue'>"+ classes[i] + '   ' +"</span>");
                    $(symbolsContainer).append(legendCircle);
                    lastRadius = currentRadius;
                }
                $(legendContainer).append(symbolsContainer);
                return legendContainer; 
                };
                legend.addTo(map);} // end createLegend() 
                
    // Creation of the Slider
		function createSliderUI(timestamps) {
		  var sliderControl = L.control({ position: 'bottomleft'} ); 
		  sliderControl.onAdd = function(map) {
		    
		      var slider = L.DomUtil.create("input", "range-slider");
		      L.DomEvent.addListener(slider, 'mousedown', function(e) {
		          L.DomEvent.stopPropagation(e);
		      });

		    var labels = ["2021", "2022"];

		    $(slider)
		        .attr({
		          'type':'range',
		          'max': timestamps[timestamps.length-1],
		          'min':timestamps[0],
		          'step': 1, 
		          'value': String(timestamps[0])})
		        .on('input change', function() {
		            updatePropSymbols($(this).val().toString()); 
		            var i = $.inArray(this.value,timestamps);
		            $(".temporal-legend").text(labels[i]); 
		        });
		    return slider;
		  }
		  sliderControl.addTo(map);
		  createTimeLabel(timestamps[0]); 
		  }


      // Create a Legend for the Slider

		  function createTimeLabel(startTimestamp) {
		    var temporalLegend = L.control({position: 'bottomleft' }); 
		    temporalLegend.onAdd = function(map) {
		      var output = L.DomUtil.create("output", "temporal-legend");
		      $(output).text(startTimestamp);
		      return output;
		    }
		    temporalLegend.addTo(map);
		  }




		});

        </script>
   </body>
</html>



			

		
<script src="plugins/jquery/jquery.min.js"></script>

<!-- Bootstrap4 -->
<script src="plugins/bootstrap/bootstrap.min.js"></script>
<!-- Parallax -->
<script src="plugins/parallax/jquery.parallax-1.1.3.js"></script>
<!-- lightbox -->
<script src="plugins/lightbox2/js/lightbox.min.js"></script>
<!-- Owl Carousel -->
<script src="plugins/slick/slick.min.js"></script>
<!-- filter -->
<script src="plugins/filterizr/jquery.filterizr.min.js"></script>
<!-- Smooth Scroll js -->
<script src="plugins/smooth-scroll/smooth-scroll.min.js"></script>
<!-- Google Map -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCcABaamniA6OL5YvYSpB3pFMNrXwXnLwU"></script>
<script src="plugins/google-map/gmap.js"></script>

<!-- Custom js -->
<script src="js/script.js"></script>

</body>

</html>